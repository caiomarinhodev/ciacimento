<table id="table" class="table table-bordered table-striped" class="display"
       cellspacing="0" width="100%">
    <thead>
    <tr>
        <th>ID</th>
        <th>ESTABELECIMENTO</th>
        <th>N° ENTREGAS</th>
        <th>VALOR TOTAL</th>
        <th>STATUS</th>
        <th>CRIADO EM</th>
        <th></th>
    </tr>
    </thead>
    <tbody>
    {% for pedido in pedidos %}
        <tr>
            <td>{{ pedido.id }}</td>
            <td>
                {{ pedido.estabelecimento }}
            </td>
            <td>
                {{ pedido.ponto_set.all|length }}
            </td>
            <td>
                {{ pedido.valor_total }}
            </td>
            <td>
                {% if pedido.status %}
                    <label class="label label-success"><i
                            class=""></i>
                        DISPONÍVEL</label>
                {% else %}
                    <label class="label label-danger"><i
                            class=""></i> ENTREGUE</label>
                {% endif %}
            </td>
            <td>{{ pedido.created_at|date:"d/m/Y G:i" }}</td>
            <td>
                {% if pedido.status and user.motorista.ocupado == False %}
                    <a href="#" class="btn btn-primary aceitar_corrida_{{ pedido.pk }}">
                        Aceitar Corrida
                    </a>
                {% elif pedido.motorista.user.id ==  user.id %}
                    <a href="#" class="btn btn-danger cancelar_corrida_{{ pedido.pk }}">
                        Cancelar Corrida
                    </a>
                {% endif %}

                <script>
                    $(document).ready(function () {
                        $('.aceitar_corrida_{{ pedido.pk }}').click(function () {
                            swal({
                                    title: "Deseja fazer a corrida ?",
                                    text: "Buscar o pedido na Loja {{ pedido.estabelecimento.user.first_name }},  localizado na {{ pedido.estabelecimento.endereco }}, {{ pedido.estabelecimento.numero }}, {{ pedido.estabelecimento.bairro }}. Valor da Entrega: {{ pedido.valor_total }}.",
                                    type: "warning",
                                    showCancelButton: true,
                                    confirmButtonClass: "btn-danger",
                                    confirmButtonText: "Confirmar Corrida",
                                    cancelButtonText: "Cancelar",
                                    closeOnConfirm: false
                                },
                                function (isConfirm) {
                                    if (isConfirm) {
                                        swal({
                                                title: "Confirmado!",
                                                text: "Se tiver problemas ligue para a loja: {{ pedido.estabelecimento.phone }}",
                                                type: "success",
                                                confirmButtonClass: "btn-success",
                                                confirmButtonText: "OK"
                                            },
                                            function () {
                                                window.location.href = '/accept-corrida/{{ pedido.pk }}';
                                            });
                                    }
                                });
                        });

                    });
                </script>
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>